---
title: '2015-05-22'
author: "??—è?‚å»·"
date: "5/22/2019"
output: html_document
---

## midterm 6.2

```{r}
library(readr)
invoiceList <- read_csv("https://raw.githubusercontent.com/tpemartin/github-data/master/invoiceList.csv",
col_types = cols(è¨‚å–®??‚é??.ä»¥è?‚å–®??‚å?€é¡¯ç¤º. = col_character()))
names(invoiceList)[[2]] <- "è¨‚å–®??‚å?€ä¹‹ä?‹å–®??‚é??"
```

```{r}
TY<-invoiceList$è¨‚å–®??‚å?€=="Asia/Taipei"
NY<-invoiceList$è¨‚å–®??‚å?€=="America/New_York"
tydate<-ymd_hms(invoiceList$è¨‚å–®??‚å?€ä¹‹ä?‹å–®??‚é?“[TY],tzone="Asia/Taipei")
tydate1<-with_tz(tydate,tzone="UTC")
nydate<-ymd_hms(invoiceList$è¨‚å–®??‚å?€ä¹‹ä?‹å–®??‚é?“[NY],tzone="America/New_York")
nydate1<-with_tz(nydate,tzone="UTC")
list(nydate1)
```
è«‹æ?Šä»¥America/New_York??‚å?€è¼¸å…¥??„æ?‚é?“å?—ä¸²"1973-02-21 12:05:22"ï¼Œè?‰æ?date time class, ??æ”¹??Asia/Taipei??‚é?“é¡¯ç¤ºã€?

```{r}
timezonechange<-ymd_hms("1973-02-21 12:05:22",tzone="America/New_York")
timezonechange1<-with_tz(timezonechange,tzone="Asia/Taipei")
timezonechange1
```
```{r}
timechange_fun<-function(input,fromtzone,totzone){
  time1<- ymd_hms(input,tz=fromtzone)
  answer<-with_tz(time1,tzone = totzone)
  return(answer)
}
timechange_fun(tydate,"America/New_York","Asia/Taipei")
timechange_fun(nydate,"Asia/Taipei","America/New_York")
```

ymd_hms_tzChange <- function(input,fromTzone,toTzone){
  time1 <- ymd_hms(input,tz=fromTzone)
  answer <- with_tz(time1,tzone = toTzone)
  return(answer)
}
ymd_hms_tzChange("1973-02-21 12:05:22","America/New_York","Asia/Taipei")


```{r}
library(lubridate)
```
```{r}
studentID <-"92aS67fee" 
transcriptDataFinal$å­¸è??==studentID -> logiChosenStudent

subSample <- transcriptDataFinal[logiChosenStudent,]

sum(subSample$å­¸æ?Ÿæ?ç¸¾*subSample$å­¸å?†æ•¸)/
  sum(subSample$å­¸å?†æ•¸) -> GPA
```

```{r}
library(readr)
transcriptDataFinal <- read_csv("https://raw.githubusercontent.com/tpemartin/github-data/master/transcriptDataFinal.csv")
```

```{r}
gpa_fun <- function(studentID){
  transcriptDataFinal$å­¸è??==studentID -> logiChosenStudent
  
  subSample <- transcriptDataFinal[logiChosenStudent,]
  
  sum(subSample$å­¸æ?Ÿæ?ç¸¾*subSample$å­¸å?†æ•¸)/
    sum(subSample$å­¸å?†æ•¸) -> GPA
  return(GPA)
}
```

```{r}
gpa_fun("479W9ee8e")
gpa_fun("9efW9aea5")
```
```{r}
library(stringr)
sample(99:103,15,replace = T)-> yy
sample(1:12,15,replace=T)-> mm
str_c("æ°‘å??",str_pad(yy,3,"left","0"),"å¹?",mm,"???") -> twDates
twDates
```

```{r}
library(stringr); library(lubridate)
yyyy<-as.integer(str_extract(twDates,"(?<=(æ°‘å??))[:digit:]+"))+1911
mm<-str_extract(twDates,"[:digit:]+(?=???)")
yyyymmdd <- ymd(str_c(yyyy,mm,"01",sep="-"))
yyyymmdd
```
è«‹å¯«ä¸€?€‹å‡½?•¸?…¶??ç¨±?‚ºdate_convert_twYMï¼Œä?”date_convert_twYM(x)?¯ä»¥æ?Šä?€?€‹æ?‘å?‹å¹´??ˆå?—ä¸²?‰©ä»¶xè½‰æ?date time class??„è¥¿??ƒå¹´??ˆæ—¥?‰©ä»¶è¼¸?‡º?€?

```{r}
date_convert_TWYM<-function(IN){
  yyyy<-as.integer(str_extract(IN,"(?<=(æ°‘å??))[:digit:]+"))+1911
mm<-str_extract(IN,"[:digit:]+(?=???)")
ans<- ymd(str_c(yyyy,mm,"01",sep="-")) 
return(ans)

}
  
date_convert_TWYM(twDates)
```
³Ð³y¤@­Ódemand_supply_fun(P,a,b,c,d)¡A¥¦·|¿é¥X¤@­Ólist¥]§t¤T­Ó¤¸¯À¡G¨Ñµ¹¶q¡A»Ý¨D¶q¡A¶WÃB¨Ñµ¹¶q
```{r}
demand_supply_fun<-function(p,a,b,c,d){
  qs<-a+b*p
  qd<-c-d*p
  es<-qs-qd
  return(list(¨Ñµ¹¶q=qs,»Ý¨D¶q=qd,¶WÃB¨Ñµ¹¶q=es))
}

```

```{r}
a <-  readline(prompt = "½Ð¿é¤J¤@­Ó¼Æ¦r¡G ")
if(a < 0) {
  print("a¬°­t­È")
} else {
  print("a¤£¬°­t­È")
}

```

```{r}
gpa_fun("92aS67fee") # Åã¥Ü82.85276
gpa_fun("aa829838s") # ¬dµL¦¹¾Ç¸¹
```

